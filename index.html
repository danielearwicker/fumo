<!DOCTYPE html>
<html>
    <head>
        <title>Fumo</title>
        <script src="knockout-3.0.0.js"></script>
        <script src="ecma-poly.js"></script>
        <script src="ko-bindings.js"></script>
        <script src="stacktrace.js"></script>
        <script src="index.js"></script>
        <style>
            body {
                font-family: Helvetica, Segoe, Arial;
                font-size: 10pt;
                background: #c9ddef;
            }
            .toolBar {
                position: absolute;
                left: 4px;
                top: 4px;
                right: 4px;
                height: 58px;
            }
            .leftPane {
                position: absolute;
                left: 0;
                top: 58px;
                width: 60%;
                bottom: 0;
            }
            .rightPane {
                position: absolute;
                right: 0;
                top: 58px;
                width: 40%;
                bottom: 0;
            }
            .rightUpperPane {
                position: absolute;
                left: 0;
                right: 0;
                top: 0;
                height: 50%;
            }
            .rightLowerPane {
                position: absolute;
                left: 0;
                right: 0;
                height: 50%;
                bottom: 0;
            }
            .stepList {
                position: absolute;
                left: 4px;
                top: 0;
                right: 2px;
                bottom: 4px;
                overflow: auto;
                border-radius: 4px;
                border: 1px solid gray;
                background: #ede6d4;
            }
            .step {
                margin-top: 4px;
                border: 1px solid gray;
                padding: 6px;
                border-radius: 4px;
                background: #fff5ee;
                display: inline-block;
            }
            .step.stepDisabled {
                background: #d3d3d3;
            }
            .step.stepSelected {
                border: 2px solid black;
            }
            .step.searchHit {
                background: #fbd850;
            }
            .step img {
                float: left;
            }
            .stepId {
                font-weight: bold;
            }
            .stepDescription {
                font-style: italic;
                white-space:nowrap;
            }
            .stepStatus {
                color: #2f4f4f;
            }
            .stepLogsContainer {
                max-height: 200px;
                overflow: auto;
            }
            .stepLogs {
                font-size: 9pt;
            }
            .running {
                background: #add8e6;
            }
            a {
                text-decoration: underline;
                color: #00008b;
            }

            .settings {
                position: absolute;
                left: 2px;
                top: 0;
                right: 4px;
                bottom: 4px;
                overflow: auto;
                border-radius: 4px;
                border: 1px solid gray;
                background: #ddfff3;
            }
            .setting {
                margin: 3px;
            }
            .setting input {
                width: 97%
            }
            .dirtySettings {
                margin-top: 8px;
                font-weight: bold;
            }

            .interactive {
                position: absolute;
                left: 2px;
                top: 0;
                right: 4px;
                bottom: 4px;
                overflow: auto;
                border-radius: 4px;
                border: 1px solid gray;
                background: #ede1ff;
            }
            .interactiveInputWrapper {
                position: absolute;
                left: 4px;
                top: 4px;
                right: 70px;
                height: 24px;
            }
            .interactiveInputWrapper input {
                width: 100%;
            }
            .interactiveTry {
                position: absolute;
                right: 4px;
                top: 5px;
                width: 60px;
                height: 24px;
            }
            .interactiveResult {
                position: absolute;
                left: 4px;
                top: 32px;
                right: 4px;
                bottom: 4px;
                overflow: auto;
                border: 1px solid silver;
                background: white;
            }
        </style>
    </head>
    <body>
        <div class="toolBar">
            <div>
                <span>Test:</span>
                <span data-bind="text: testFile"></span>
                <input type="file" data-bind="value: selectedTestFile">
            </div>
            <div>
                <button data-bind="click: reload, enable: canReload">Reload</button>
                <button data-bind="click: start, enable: canStart">Start</button>
                <button data-bind="click: stop, enable: canStop">Stop</button>
                <button data-bind="click: reset, enable: canReset">Reset</button>
                <button data-bind="click: enableAll, enable: canEnableAll">All</button>
                <button data-bind="click: disableAll, enable: canDisableAll">None</button>
                <!-- ko if: selectedStep -->
                <button data-bind="click: first">First</button>
                <button data-bind="click: last">Last</button>
                <!-- /ko -->
                <button data-bind="click: debug">Debug</button>
                <span>Search: </span>
                <input type="text" data-bind="value: searchText, valueUpdate: 'afterkeydown'">
                <!-- ko if: searchResults().length > 1 -->
                <button data-bind="click: function() { searchNextResult(-1); }">&lt;</button>
                <button data-bind="click: function() { searchNextResult(1); }">&gt;</button>
                <!-- /ko -->
                <!-- ko if: searchText -->
                <button data-bind="click: function() { searchText('') }">X</button>
                <!-- /ko -->
            </div>
        </div>
        <div class="leftPane">
            <div class="stepList">
                <div data-bind="foreach: steps">
                    <div>
                        <div class="step"
                             data-bind="css: {
                                            running: running,
                                            stepDisabled: !isEnabled(),
                                            stepSelected: $parent.selectedStep() === $data,
                                            searchHit: isSearchHit
                                        },
                                        style: { marginLeft: (4 + (depth * 24))+'px' },
                                        event: { click: select },
                                        initElement: initElement">
                            <img data-bind="attr: { src: 'img/' + image() + '.png' }">
                            <div>
                                <label>
                                    <input type="checkbox"
                                           data-bind="checked: isEnabled,
                                                      properties: { indeterminate: ko.unwrap(enabledState) === 0 }">
                                    <span class="stepId" data-bind="text: id"></span>
                                    <span class="stepDescription" data-bind="text: description"></span>
                                </label>
                            </div>
                            <div>
                                <!-- ko if: showingLogs -->
                                <div class="stepLogsContainer">
                                    <div class="stepLogs" data-bind="foreach: logs">
                                        <div data-bind="text: $data"></div>
                                    </div>
                                </div>
                                <!-- /ko -->
                                <!-- ko if: !showingLogs() -->
                                <span class="stepStatus" data-bind="text: status"></span>
                                <!-- /ko -->
                                <!-- ko if: logs().length > 1 -->
                                <a data-bind="click: function() { showingLogs(!showingLogs()) },
                                              text: showingLogs() ? 'Less' : 'More'"></a>
                                <!-- /ko -->
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="rightPane">
            <div class="rightUpperPane">
                <div class="settings">
                    <div data-bind="foreach: settings">
                        <div class="setting">
                            <div><span data-bind="text: name"></span> <button data-bind="click: clear">x</button></div>
                            <div><input type="text" data-bind="value: value, valueUpdate: 'afterkeydown'"></div>
                        </div>
                    </div>
                    <!-- ko if: dirtySettings -->
                    <div class="dirtySettings">Reload the test to apply your changed settings</div>
                    <!-- /ko -->
                </div>
            </div>
            <div class="rightLowerPane">
                <div class="interactive">
                    <div class="interactiveInputWrapper">
                        <input type="text"
                               data-bind="value: interactiveCode,
                                          event: { keyup: interactiveKeyDown }">
                    </div>
                    <button class="interactiveTry"
                            data-bind="click: interactiveTry,
                                       enable: !interactiveTrying()">Try</button>
                    <div class="interactiveResult">
                        <pre data-bind="text: interactiveResult"></pre>
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>